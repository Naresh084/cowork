# M2-05 Evidence

## Change Summary

- Added extractor-side contradiction filtering to reject lower-confidence opposing candidates with same semantic key.
- Added extractor-side sensitivity heuristics (token/credential/email-like patterns) to block risky memory persistence even when model marks candidate non-sensitive.
- Added middleware-side contradiction guard against already persisted memories and emits `memory:conflict_detected` events.
- Added provenance retention tags on saved auto memories (`scope:*`, `stable:*`, `source:auto_extract`).
- Added calibration-style extractor test for benign candidate retention with measured false-positive threshold (`<1%`).

## Files Changed

- apps/desktop/src-sidecar/src/memory/semantic-memory-extractor.ts
- apps/desktop/src-sidecar/src/memory/memory-middleware.ts
- apps/desktop/src-sidecar/src/memory/semantic-memory-extractor.test.ts

## Verification Commands

```bash
pnpm --filter @cowork/sidecar test -- src/memory/semantic-memory-extractor.test.ts
pnpm --filter @cowork/sidecar typecheck
```

## Verification Output Summary

- Semantic extractor test suite passes (`6/6`).
- Includes benign-candidate false-positive assertion with threshold `<1%`.
- Sidecar typecheck passes.

## Acceptance Mapping

- Plan acceptance criteria: Add contradiction and sensitivity filters with provenance retention; sensitive-memory false-positive persistence <1%.
- Result: Implemented with contradiction/sensitivity filtering, provenance tagging, and threshold-guarded test coverage.

## Residual Risks

- Threshold is validated on deterministic synthetic fixtures; real-world corpus calibration should continue in benchmark runs.

## Rollback Path

- Revert contradiction/sensitivity helper blocks, middleware conflict guard, and extractor calibration test.
