# M2-08 Evidence

## Change Summary

- Extended desktop memory store with deep-query result modeling for:
  - per-atom query score,
  - confidence score,
  - ranked explanation reasons.
- Added store APIs to call `deep_memory_query` and `deep_memory_feedback`.
- Added feedback log state (`lastFeedback`, bounded `feedbackLog`) for iterative ranking improvement loops.
- Added selector hooks for deep query and feedback state surfaces.
- Integrated deep query evidence + feedback actions into memory inspector UI flow.

## Files Changed

- apps/desktop/src/stores/memory-store.ts
- apps/desktop/src/stores/index.ts
- apps/desktop/src/stores/memory-store.test.ts
- apps/desktop/src/components/memory/MemoryInspector.tsx
- apps/desktop/src/components/memory/MemoryPanel.tsx

## Verification Commands

```bash
pnpm --filter @cowork/desktop test -- src/stores/memory-store.test.ts
pnpm --filter @cowork/desktop typecheck
pnpm --filter @cowork/sidecar typecheck
```

## Verification Output Summary

- New store tests pass (`3/3`) covering deep query ranking/explanations, feedback persistence, and validation errors.
- Desktop and sidecar typecheck pass with new memory store APIs.

## Acceptance Mapping

- Plan acceptance criteria: Extend memory store to support confidence/explanations and feedback APIs.
- Result: Completed. Store APIs are implemented, tested, and wired to inspector-facing usage.

## Residual Risks

- Full end-to-end memory quality benchmarks (`Q10-05`) remain pending for production-quality validation.

## Rollback Path

- Revert deep-query/feedback additions in memory store and remove new store tests.
