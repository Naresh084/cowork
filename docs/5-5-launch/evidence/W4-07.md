# W4-07 Evidence

## Change Summary

- Added workflow pack invocation API in workflow tool layer:
  - new tool: `execute_workflow_pack`
  - file: `/Users/naresh/Work/Personal/geminicowork/apps/desktop/src-sidecar/src/tools/workflow-tool.ts`
- `execute_workflow_pack` supports:
  - explicit workflow id execution,
  - adaptive trigger-based workflow selection using trigger confidence diagnostics,
  - optional activation requirement checks,
  - queued run response with trigger context + diagnostics.
- Added typed workflow error mapping across workflow tools with structured error payloads:
  - error codes (`invalid_request`, `workflow_not_found`, `workflow_archived`, `workflow_validation_failed`, `trigger_match_not_found`, `run_not_found`, `timeout`, `internal_error`),
  - retryability hint,
  - actionable suggestion text.
- Added tool tests validating pack execution path and typed error behavior:
  - `/Users/naresh/Work/Personal/geminicowork/apps/desktop/src-sidecar/src/tools/workflow-tool.test.ts`

## Files Changed

- /Users/naresh/Work/Personal/geminicowork/apps/desktop/src-sidecar/src/tools/workflow-tool.ts
- /Users/naresh/Work/Personal/geminicowork/apps/desktop/src-sidecar/src/tools/workflow-tool.test.ts

## Verification Commands

```bash
pnpm --filter @gemini-cowork/sidecar test -- src/tools/workflow-tool.test.ts
pnpm --filter @gemini-cowork/sidecar typecheck
```

## Verification Output Summary

- Workflow tool suite passes (`3/3`).
- Sidecar typecheck passes.

## Acceptance Mapping

- Plan acceptance criteria: workflow pack invocation API + typed error mapping with actionable outputs.
- Result: met.

## Residual Risks

- Frontend-specific card rendering enhancements for these typed errors are still part of later workflow UI tasks.

## Rollback Path

- Remove `execute_workflow_pack` tool and revert typed error mapping helper path in `workflow-tool.ts`.
