# O9-01 Evidence

## Change Summary

- Added explicit event schema envelope versioning in sidecar event stream (`schemaVersion`).
- Added run/session correlation IDs in event envelope (`correlationId`) with stable propagation:
  - uses `sessionId:runId` when `runId` is present,
  - falls back to stable per-session correlation when run ID is absent.
- Preserved existing replay/event sequencing while enriching each event with correlation metadata.

## Files Changed

- apps/desktop/src-sidecar/src/event-emitter.ts
- apps/desktop/src-sidecar/src/event-emitter.test.ts

## Verification Commands

```bash
pnpm --filter @gemini-cowork/sidecar typecheck
pnpm --filter @gemini-cowork/sidecar test -- src/event-emitter.test.ts
```

## Verification Output Summary

- Sidecar typecheck: pass (`tsc --noEmit`).
- Event emitter tests: pass (`4 passed`).

## Acceptance Mapping

- Plan acceptance criteria: `O9-01` event schema versioning + run-level correlation IDs.
- Result: Completed. Sidecar events now carry versioned schema metadata and deterministic correlation IDs.

## Residual Risks

- Rust-side realtime event forwarding currently ignores extra envelope fields by design; correlation is guaranteed on sidecar replay/API paths and may require explicit Rust struct expansion for future end-to-end parity.
