# R1-08 Evidence

## Change Summary

- Added sidecar reliability counter tracking in event emitter with live `run:health` events.
- Reliability counters now track:
  - stream starts/completions,
  - checkpoints,
  - stalled/recovered/fallback runs,
  - top-level errors,
  - tool errors.
- Added computed reliability score and health classification (`healthy` / `degraded` / `unhealthy`).
- Extended event contracts/parsers to include `run:health`.
- Wired benchmark store to ingest run-health snapshots.
- Surfaced live reliability status/counters in benchmark dashboard.
- Added sidecar tests for run-health event emission and counter integrity.

## Files Changed

- apps/desktop/src-sidecar/src/event-emitter.ts
- apps/desktop/src-sidecar/src/event-emitter.test.ts
- apps/desktop/src-sidecar/src/types.ts
- apps/desktop/src/lib/event-types.ts
- apps/desktop/src/lib/agent-events.ts
- apps/desktop/src/hooks/useAgentEvents.ts
- apps/desktop/src/stores/benchmark-store.ts
- apps/desktop/src/components/benchmark/BenchmarkDashboard.tsx

## Verification Commands

```bash
pnpm --filter @gemini-cowork/sidecar test -- src/event-emitter.test.ts src/providers/gemini-provider.taxonomy.test.ts
pnpm --filter @gemini-cowork/desktop typecheck
pnpm --filter @gemini-cowork/sidecar typecheck
```

## Verification Output Summary

- Event emitter reliability tests pass.
- Desktop and sidecar typecheck pass with new run-health event flow.

## Acceptance Mapping

- Plan acceptance criteria: Emit reliability counters and structured run health events; benchmark console shows live reliability metrics.
- Result: Completed. Counters + health events are emitted and visible in benchmark dashboard.

## Residual Risks

- Reliability score formula is heuristic and should be calibrated against production benchmark traces.

## Rollback Path

- Revert run-health event emission and frontend/store consumption updates.
