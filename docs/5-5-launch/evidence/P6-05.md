# P6-05 Evidence

## Change Summary

- Extended tool-policy shared contracts in:
  - `/Users/naresh/Work/Personal/cowork/packages/shared/src/types/tool-policy.ts`
- Added:
  - enterprise policy profiles: `enterprise_balanced`, `enterprise_strict`,
  - policy reason-code enums: `PolicyReasonCode`, `PolicyDenyReasonCode`,
  - explainability fields on evaluation result (`reasonCode`, `explainability`).
- Updated sidecar policy engine profile coverage and reason-code emission:
  - `/Users/naresh/Work/Personal/cowork/apps/desktop/src-sidecar/src/tool-policy.ts`
- Updated policy modal profile options:
  - `/Users/naresh/Work/Personal/cowork/apps/desktop/src/components/modals/ToolPolicyModal.tsx`
- Added reason-code unit tests:
  - `/Users/naresh/Work/Personal/cowork/apps/desktop/src-sidecar/src/tool-policy.explainability.test.ts`

## Files Changed

- /Users/naresh/Work/Personal/cowork/packages/shared/src/types/tool-policy.ts
- /Users/naresh/Work/Personal/cowork/apps/desktop/src-sidecar/src/tool-policy.ts
- /Users/naresh/Work/Personal/cowork/apps/desktop/src/components/modals/ToolPolicyModal.tsx
- /Users/naresh/Work/Personal/cowork/apps/desktop/src-sidecar/src/tool-policy.explainability.test.ts

## Verification Commands

```bash
pnpm --filter @cowork/shared build
pnpm --filter @cowork/sidecar typecheck
pnpm --filter @cowork/desktop typecheck
pnpm --filter @cowork/sidecar test -- src/tool-policy.explainability.test.ts
```

## Verification Output Summary

- Shared/sidecar/desktop typechecks pass.
- `tool-policy.explainability.test.ts` passes (`3/3`) for global/profile/default reason-code behavior.

## Acceptance Mapping

- Plan acceptance criteria: enterprise policy profile extensions and auditable deny-reason enums.
- Current result: implemented in shared contracts and sidecar evaluator outputs.

## Residual Risks

- Policy editor impact-preview UX remains pending (`P6-06`).

## Rollback Path

- Revert added enterprise profiles and reason-code fields in shared/sidecar policy modules.
