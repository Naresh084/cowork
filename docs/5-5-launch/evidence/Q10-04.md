# Q10-04 Evidence

## Change Summary

- Completed deterministic reliability E2E coverage with five scenarios:
  - `stalled run can be recovered with one click`,
  - `permission requests remain visible after reload`,
  - `permission queue batch actions resolve all queued approvals`,
  - `permission queue keyboard shortcuts resolve the selected request`,
  - `queued messages survive reload for restart-resume continuity`.
- Stabilized the Playwright desktop bridge mock and persisted bootstrap seeding across reloads for restart-resume checks.
- Added command-level assertions for permission response envelopes (`agent_respond_permission`) to validate resilient decision handling.

## Files Changed

- apps/desktop/e2e/reliability.spec.ts
- apps/desktop/playwright.reliability.local.config.ts
- apps/desktop/src/stores/chat-store.ts
- apps/desktop/src/components/dialogs/PermissionDialog.tsx

## Verification Commands

```bash
pnpm run dev:vite
pnpm playwright test e2e/reliability.spec.ts --project=chromium --config playwright.reliability.local.config.ts
```

## Verification Output Summary

- Reliability E2E suite passes in Chromium:
  - `5 passed (6.0s)` for `apps/desktop/e2e/reliability.spec.ts`.

## Acceptance Mapping

- Plan acceptance criteria: Add reliability E2E coverage for stream recovery, permission queue, and restart-resume.
- Result: Completed. Required reliability UX scenarios are implemented and passing in E2E with explicit permission-resilience checks.

## Residual Risks

- Full multi-browser parity (`firefox`/`webkit`) still needs explicit periodic validation for this suite.
- Chaos-injected reliability scenarios remain tracked under `Q10-07`.

## Rollback Path

- Revert `apps/desktop/e2e/reliability.spec.ts`.
