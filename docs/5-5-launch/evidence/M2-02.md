# M2-02 Evidence

## Change Summary

- Finalized schema v6 memory persistence path with repository coverage and integration tests.
- Added storage test harness for memory atom/query repositories and verified CRUD, search, query log, and feedback flows.
- Added migration diagnostics command path used by settings runtime diagnostics.

## Files Changed

- packages/storage/src/repositories/memory-atom.ts
- packages/storage/src/repositories/memory-query.ts
- packages/storage/src/database.ts
- packages/storage/src/index.ts
- packages/storage/test/memory-repositories.test.ts
- packages/storage/package.json
- apps/desktop/src-sidecar/src/types.ts
- apps/desktop/src-sidecar/src/ipc-handler.ts
- apps/desktop/src-sidecar/src/memory/memory-service.ts
- apps/desktop/src-tauri/src/commands/deep.rs
- apps/desktop/src-tauri/src/main.rs
- apps/desktop/src/components/settings/RuntimeSettings.tsx

## Verification Commands

```bash
pnpm --filter @gemini-cowork/storage test
pnpm --filter @gemini-cowork/storage typecheck
pnpm --filter @gemini-cowork/sidecar test -- src/memory/memory-service.migration.test.ts
pnpm --filter @gemini-cowork/sidecar typecheck
pnpm --filter @gemini-cowork/desktop typecheck
cd apps/desktop/src-tauri && cargo check
```

## Verification Output Summary

- Storage memory repository integration tests pass (2/2).
- Sidecar migration import test passes (1/1).
- Storage/sidecar/desktop typecheck passes.
- Tauri Rust command layer compiles with migration diagnostics command registered.

## Acceptance Mapping

- Plan acceptance criteria: Memory tables + repositories with CRUD/query operations.
- Result: Complete, with integration tests and command-path verification.

## Residual Risks

- Repository tests currently cover core flows and not high-volume soak behavior.

## Rollback Path

- Revert storage memory repository test harness and migration diagnostics command path.
